{% extends 'base.html' %}

{% block title %}{{ profile.user.get_full_name|default:profile.user.username }} - Profile{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-3">
        <!-- Profile Card -->
        <aside style="background: white; border: 1px solid #e8e8e8; padding: 2rem; text-align: center; position: sticky; top: 120px;">
            {% if profile.avatar %}
                <img src="{{ profile.avatar.url }}" alt="{{ profile.user.username }}" style="width: 120px; height: 120px; border-radius: 50%; object-fit: cover; display: block; margin: 0 auto 1rem;">
            {% else %}
                <div style="width: 120px; height: 120px; border-radius: 50%; background: #e8e8e8; display: inline-flex; align-items: center; justify-content: center; font-size: 2.5rem; color: #999; margin: 0 auto 1rem;">
                    üë§
                </div>
            {% endif %}
            
            <h2 style="font-family: 'Georgia', serif; font-size: 1.2rem; margin: 0 0 0.3rem 0; color: #333;">
                {{ profile.user.get_full_name|default:profile.user.username }}
            </h2>
            <p style="color: #999; font-size: 0.9rem; margin: 0 0 1rem 0;">@{{ profile.user.username }}</p>
            
            <p style="display: inline-block; font-size: 0.75rem; letter-spacing: 0.5px; text-transform: uppercase; color: #d4af37; margin-bottom: 1.5rem;">
                {{ profile.get_role_display }}
            </p>
            
            {% if profile.website %}
                <p style="margin: 1rem 0;">
                    <a href="{{ profile.website }}" target="_blank" style="color: #333; text-decoration: none; border: 1px solid #333; padding: 0.5rem 1rem; display: inline-block; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 0.5px; transition: all 0.3s ease;">
                        Visit Website
                    </a>
                </p>
            {% endif %}
            
            <p style="margin-top: 1rem;">
                <a href="{% url 'accounts:profile_edit' %}" style="display: inline-block; width: 100%; background: #333; color: white; padding: 0.6rem 1rem; text-decoration: none; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 0.5px; transition: all 0.3s ease; box-sizing: border-box;">
                    Edit Profile
                </a>
            </p>
        </aside>
    </div>

    <div class="col-lg-9">
        <!-- Bio Section -->
        {% if profile.bio %}
            <div style="background: white; border: 1px solid #e8e8e8; padding: 2rem; margin-bottom: 2rem;">
                <h3 style="font-family: 'Georgia', serif; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 0.5px; margin: 0 0 1rem 0; color: #333;">About</h3>
                <p style="font-family: 'Georgia', serif; color: #333; line-height: 1.6; margin: 0;">{{ profile.bio|linebreaks }}</p>
            </div>
        {% endif %}

        <!-- Statistics -->
        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2rem;">
            <div style="background: white; border: 1px solid #e8e8e8; padding: 1.5rem; text-align: center;">
                <p style="font-size: 1.8rem; font-weight: 600; color: #333; margin: 0;">{{ user_posts.count }}</p>
                <p style="font-size: 0.85rem; color: #999; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">Posts</p>
            </div>
            <div style="background: white; border: 1px solid #e8e8e8; padding: 1.5rem; text-align: center;">
                <p style="font-size: 1.8rem; font-weight: 600; color: #333; margin: 0;">{{ user_comments.count }}</p>
                <p style="font-size: 0.85rem; color: #999; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">Comments</p>
            </div>
            <div style="background: white; border: 1px solid #e8e8e8; padding: 1.5rem; text-align: center;">
                <p style="font-size: 1.8rem; font-weight: 600; color: #333; margin: 0;">0</p>
                <p style="font-size: 0.85rem; color: #999; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">Followers</p>
            </div>
            <div style="background: white; border: 1px solid #e8e8e8; padding: 1.5rem; text-align: center;">
                <p style="font-size: 1.8rem; font-weight: 600; color: #333; margin: 0;">0</p>
                <p style="font-size: 0.85rem; color: #999; text-transform: uppercase; letter-spacing: 0.5px; margin: 0;">Following</p>
            </div>
        </div>

        <!-- Recent Posts -->
        <div style="background: white; border: 1px solid #e8e8e8; padding: 2rem; margin-bottom: 2rem;">
            <h3 style="font-family: 'Georgia', serif; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 0.5px; margin: 0 0 1.5rem 0; color: #333;">Recent Posts</h3>
            {% if user_posts %}
                <div>
                    {% for post in user_posts|slice:":5" %}
                        <a href="{{ post.get_absolute_url }}" style="display: block; padding: 1rem 0; border-bottom: 1px solid #e8e8e8; text-decoration: none; color: #333; transition: all 0.3s ease;">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <div>
                                    <h4 style="font-family: 'Georgia', serif; font-size: 1rem; margin: 0 0 0.3rem 0; color: #333;">{{ post.title|truncatewords:8 }}</h4>
                                    <p style="font-size: 0.8rem; color: #999; margin: 0; text-transform: uppercase; letter-spacing: 0.5px;">
                                        {% if post.is_published %}Published{% else %}Draft{% endif %} ¬∑ {{ post.published_at|date:"F d, Y"|default:"Unpublished" }}
                                    </p>
                                </div>
                                <span style="font-size: 0.8rem; color: #d4af37; text-transform: uppercase; letter-spacing: 0.5px;">
                                    {% if post.is_published %}‚óè{% else %}‚óã{% endif %}
                                </span>
                            </div>
                        </a>
                    {% endfor %}
                </div>
                <a href="{% url 'accounts:dashboard' %}" style="display: inline-block; color: #333; border: 1px solid #333; padding: 0.5rem 1rem; text-decoration: none; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 0.5px; transition: all 0.3s ease; margin-top: 1rem;">
                    View All Posts
                </a>
            {% else %}
                <p style="color: #999; margin: 0;">No posts yet. <a href="{% url 'blog:post_create' %}" style="color: #d4af37; text-decoration: none;">Create your first post</a>!</p>
            {% endif %}
        </div>

        <!-- Recent Activity -->
        <div style="background: white; border: 1px solid #e8e8e8; padding: 2rem;">
            <h3 style="font-family: 'Georgia', serif; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 0.5px; margin: 0 0 1.5rem 0; color: #333;">Recent Activity</h3>
            {% if user_activity %}
                <div>
                    {% for activity in user_activity %}
                        <div style="padding: 1rem 0; border-bottom: 1px solid #e8e8e8;">
                            <div style="display: flex; justify-content: space-between; align-items: baseline;">
                                <h4 style="font-size: 0.95rem; margin: 0; color: #333;">{{ activity.get_activity_type_display }}</h4>
                                <small style="color: #999; font-size: 0.85rem;">{{ activity.created_at|timesince }} ago</small>
                            </div>
                            {% if activity.post %}
                                <p style="font-size: 0.9rem; color: #666; margin: 0.3rem 0 0 0;">{{ activity.post.title }}</p>
                            {% endif %}
                        </div>
                    {% endfor %}
                </div>
            {% else %}
                <p style="color: #999; margin: 0;">No activity yet.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
